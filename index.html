<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mock Test Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg: #f4f6fa;
      --card: #ffffff;
      --text: #1f2937;
      --muted: #6b7280;
      --accent: #2563eb;
      --good: #16a34a;
      --warn: #d97706;
      --bad: #dc2626;
    }

    body.dark {
      --bg: #0f172a;
      --card: #020617;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --accent: #60a5fa;
    }

    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      padding: 20px;
    }

    h1 { margin-bottom: 5px; }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .card {
      background: var(--card);
      border-radius: 12px;
      padding: 16px;
      margin-top: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.08);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 12px;
    }

    input, button {
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #cbd5f5;
      font-size: 14px;
    }

    body.dark input {
      background: #020617;
      color: var(--text);
      border-color: #334155;
    }

    button {
      background: var(--accent);
      color: white;
      border: none;
      cursor: pointer;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }

    th, td {
      padding: 8px;
      text-align: center;
      border-bottom: 1px solid #e5e7eb;
    }

    body.dark th, body.dark td {
      border-color: #334155;
    }

    .good { color: var(--good); }
    .warn { color: var(--warn); }
    .bad  { color: var(--bad); }

    .muted {
      color: var(--muted);
      font-size: 13px;
    }

    .toggle {
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      user-select: none;
    }
  </style>
</head>

<body>
  <div class="top-bar">
    <div>
      <h1>Mock Test Tracker</h1>
      <div class="muted" id="countdown"></div>
    </div>
    <div class="toggle">
      <input type="checkbox" id="darkToggle" />
      <label for="darkToggle">Dark Mode</label>
    </div>
  </div>

  <div class="card">
    <h3>Add Mock Test</h3>
    <div class="grid">
      <input id="testName" placeholder="Test Name" />
      <input id="english" type="number" placeholder="English" />
      <input id="maths" type="number" placeholder="Maths" />
      <input id="reasoning" type="number" placeholder="Reasoning" />
      <input id="ga" type="number" placeholder="GA" />
      <button onclick="addTest()">Add Test</button>
    </div>
  </div>

  <div class="card">
    <h3>Performance Overview</h3>
    <div class="grid">
      <div>
        <strong>Overall Consistency</strong>
        <div id="consistencyScore" class="muted"></div>
      </div>
      <div>
        <strong>Attempt Strategy Insight</strong>
        <div id="strategyInsight" class="muted"></div>
      </div>
    </div>
  </div>

  <div class="card">
    <h3>Section-wise Consistency</h3>
    <table>
      <thead>
        <tr>
          <th>Section</th>
          <th>Consistency</th>
        </tr>
      </thead>
      <tbody id="sectionConsistency"></tbody>
    </table>
  </div>

  <div class="card">
    <h3>All Tests</h3>
    <table>
      <thead>
        <tr>
          <th>Test</th>
          <th>Eng</th>
          <th>Maths</th>
          <th>Reason</th>
          <th>GA</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>

<script>
/* ---------------- CORE DATA ---------------- */

const EXAM_DATE = new Date("2026-03-15");
let tests = JSON.parse(localStorage.getItem("mockTests")) || [];

/* ---------------- DARK MODE ---------------- */

const darkToggle = document.getElementById("darkToggle");
if (localStorage.getItem("darkMode") === "on") {
  document.body.classList.add("dark");
  darkToggle.checked = true;
}

darkToggle.addEventListener("change", () => {
  document.body.classList.toggle("dark");
  localStorage.setItem("darkMode", darkToggle.checked ? "on" : "off");
});

/* ---------------- COUNTDOWN ---------------- */

function updateCountdown() {
  const today = new Date();
  const diff = Math.ceil((EXAM_DATE - today) / (1000 * 60 * 60 * 24));
  countdown.textContent = diff >= 0 ? `‚è≥ ${diff} days to exam` : "Exam date passed";
}

/* ---------------- ADD TEST ---------------- */

function addTest() {
  const test = {
    name: testName.value || `Test ${tests.length + 1}`,
    eng: +english.value || 0,
    maths: +maths.value || 0,
    reason: +reasoning.value || 0,
    ga: +ga.value || 0
  };

  tests.push(test);
  localStorage.setItem("mockTests", JSON.stringify(tests));
  render();
}

/* ---------------- HELPERS ---------------- */

function consistencyLabel(values) {
  if (values.length < 2) return ["Need more data", "muted"];

  const avg = values.reduce((a,b)=>a+b,0) / values.length;
  const sd = Math.sqrt(values.reduce((a,b)=>a+(b-avg)**2,0)/values.length);

  if (sd < 3) return ["Excellent", "good"];
  if (sd < 7) return ["Moderate", "warn"];
  return ["Unstable", "bad"];
}

/* ---------------- OVERALL CONSISTENCY ---------------- */

function calculateOverallConsistency() {
  const totals = tests.map(t => t.eng + t.maths + t.reason + t.ga);
  return consistencyLabel(totals)[0];
}

/* ---------------- SECTION CONSISTENCY ---------------- */

function renderSectionConsistency() {
  sectionConsistency.innerHTML = "";

  const sections = {
    English: tests.map(t => t.eng),
    Maths: tests.map(t => t.maths),
    Reasoning: tests.map(t => t.reason),
    GA: tests.map(t => t.ga)
  };

  for (let s in sections) {
    const [label, cls] = consistencyLabel(sections[s]);
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${s}</td><td class="${cls}">${label}</td>`;
    sectionConsistency.appendChild(tr);
  }
}

/* ---------------- STRATEGY INSIGHT ---------------- */

function strategyInsight() {
  if (!tests.length) return "No data yet";

  const avg = {
    ENG: tests.reduce((a,t)=>a+t.eng,0)/tests.length,
    MATHS: tests.reduce((a,t)=>a+t.maths,0)/tests.length,
    REASON: tests.reduce((a,t)=>a+t.reason,0)/tests.length,
    GA: tests.reduce((a,t)=>a+t.ga,0)/tests.length
  };

  const weakest = Object.keys(avg).reduce((a,b)=>avg[a]<avg[b]?a:b);
  return `Increase attempts & accuracy in ${weakest}`;
}

/* ---------------- RENDER ---------------- */

function render() {
  tableBody.innerHTML = "";

  tests.forEach(t => {
    const total = t.eng + t.maths + t.reason + t.ga;
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${t.name}</td>
      <td>${t.eng}</td>
      <td>${t.maths}</td>
      <td>${t.reason}</td>
      <td>${t.ga}</td>
      <td><strong>${total}</strong></td>
    `;
    tableBody.appendChild(tr);
  });

  consistencyScore.textContent = calculateOverallConsistency();
  strategyInsightEl.textContent = strategyInsight();
  renderSectionConsistency();
}

/* ---------------- INIT ---------------- */

const strategyInsightEl = document.getElementById("strategyInsight");
updateCountdown();
render();
</script>
</body>
</html>
